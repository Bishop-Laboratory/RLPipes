### R-Loop Forming Sequences (RLFS) Enrichment

RLFS were derived across the genome using [`QmRLFS-finder.py`](https://github.com/piroonj/QmRLFS-finder). R-loop broad peaks were called with `macs2` and then compared with RLFS using `permTest` from the `RegioneR` R package. An empirical distribution of RLFS was generated using the `circularRandomizeRegions` method and compared to the peaks in order to calculate enrichment p value and zscore (effect size of enrichment). 


```{r}
pt <- rlfs_data[[1]]
pval <- pt[[1]]$pval
ntimes <- pt[[1]]$ntimes
zscore <- pt[[1]]$zscore

rlfs_pval_color <- ifelse(pval > .05, 'red', ifelse(pval > .01, 'orange', 'green'))
rlfs_zs_color <- ifelse(zscore < 5, 'red', ifelse(zscore < 15, 'orange', 'green'))

lz <- rlfs_data[[2]]
```


From this analysis, the empirically-determined p value was <strong style="color: `r rlfs_pval_color`">`r pval`</strong> (with `r ntimes` permutations, the minimum possible p value was `r 1/(1 + ntimes)`).
The enrichment z-score was <strong style="color: `r rlfs_zs_color`">`r zscore`</strong>.


```{r fig.height=6, fig.width=10}
plot(pt)
```

```{r fig.height=6, fig.width=10}
to_plot <- data.frame("zscore" = lz$`regioneR::numOverlaps`$shifted.z.scores,
                      "shift" = lz$`regioneR::numOverlaps`$shifts)
plt <- ggplot(to_plot, aes(y = zscore, x = shift)) +
  geom_line() +
  labs(title = "Peak enrichment around RLFS") +
  ylab("Peak Enrichment (Z-Score)") +
  xlab("Distance to RLFS (bp)") +
  theme_bw(base_size = 15)
plotly::ggplotly(plt)

```


***
